machine:
  node:
    version: 7.5.0
  environment:
    MOCHA_OPTS: --reporter mocha-junit-reporter --reporter-options mochaFile=$CIRCLE_TEST_REPORTS/mocha/junit.xml

dependencies:
  pre:
    - ./scripts/setupNpm.sh

test:
  pre:
    - mkdir -p $CIRCLE_TEST_REPORTS/mocha
  override:
    - npm test
  post:
    - mv coverage $CIRCLE_TEST_REPORTS

deployment:
  all:
    branch: /.*/
    commands:
      - ./scripts/release.sh
